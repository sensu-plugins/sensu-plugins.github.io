<!DOCTYPE html>
<html lang="en"
>
<head>
    <title>Develop Guidelines - Sensu Plugins</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="/pages/develop-guidelines.html">

        <meta name="author" content="varied" />
        <meta name="description" content="Developer Guidelines If you have a new plugin or handler, send a pull request! Don&#39;t be afraid on pushing your PR with non-ruby code. Just let someone from team know. Maybe we can help you to rewrite your check to Ruby or even invent something completely new to test ..." />

    <meta property="og:site_name" content="Sensu Plugins" />
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Develop Guidelines"/>
    <meta property="og:url" content="/pages/develop-guidelines.html"/>
    <meta property="og:description" content="Developer Guidelines If you have a new plugin or handler, send a pull request! Don&#39;t be afraid on pushing your PR with non-ruby code. Just let someone from team know. Maybe we can help you to rewrite your check to Ruby or even invent something completely new to test ..." />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="/theme/css/pygments/monokai.css" rel="stylesheet">
    <link rel="stylesheet" href="/theme/css/style.css" type="text/css"/>


</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="/" class="navbar-brand">
Sensu Plugins            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="/pages/about.html">
                             About
                          </a></li>
                         <li class="active"><a href="/pages/develop-guidelines.html">
                             Develop Guidelines
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-9">

    <section id="content" class="body">
        <h1 class="entry-title">Develop Guidelines</h1>
        
        <div class="entry-content">
            <h1>Developer Guidelines</h1>
<p>If you have a new plugin or handler, send a pull request! Don't be afraid on pushing your PR with non-ruby code. Just let someone from <a href="https://github.com/sensu?tab=members">team</a> know. Maybe we can help you to rewrite your check to Ruby or even invent something completely new to test your work. Just don't hesitate to contact us.</p>
<h2>Naming Conventions</h2>
<p>Please format the names of scripts using dashes to separate words and with an
extension (<code>.rb</code>, <code>.sh</code>, etc), and make sure they are <code>chmod +x</code>'d.
Extensions are unfortunately necessary for Sensu to be able to directly
exec plugins and handlers on Windows.</p>
<h2>Coding Style</h2>
<p>When developing your plugins please use the <a href="https://github.com/sensu/sensu-plugin">sensu plugin class</a>.  This will ensure that all plugins have an identical run structure.</p>
<p>When using options please try and follow the following structure.  At the very least your option needs to include a description to assist the user with configration and deployment</p>
<div class="highlight"><pre><span class="n">option</span> <span class="ss">:port</span><span class="p">,</span>
<span class="ss">short</span><span class="p">:</span> <span class="s1">&#39;-p PORT&#39;</span><span class="p">,</span>
<span class="ss">long</span><span class="p">:</span> <span class="s1">&#39;--port PORT&#39;</span><span class="p">,</span>
<span class="ss">description</span><span class="p">:</span> <span class="s1">&#39;Port&#39;</span><span class="p">,</span>
<span class="ss">default</span><span class="p">:</span> <span class="s1">&#39;1234&#39;</span>
</pre></div>


<p>Each plugin, handler, mutator, extension should use the following standard header</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">#! /usr/bin/env ruby</span>
<span class="c1">#  encoding: UTF-8</span>
<span class="c1">#   &lt;script name&gt;</span>
<span class="c1">#</span>
<span class="c1"># DESCRIPTION:</span>
<span class="c1">#</span>
<span class="c1"># OUTPUT:</span>
<span class="c1">#   plain text, metric data, etc</span>
<span class="c1">#</span>
<span class="c1"># PLATFORMS:</span>
<span class="c1">#   Linux, Windows, BSD, Solaris, etc</span>
<span class="c1">#</span>
<span class="c1"># DEPENDENCIES:</span>
<span class="c1">#   gem: sensu-plugin</span>
<span class="c1">#   gem: &lt;?&gt;</span>
<span class="c1">#</span>
<span class="c1"># USAGE:</span>
<span class="c1">#</span>
<span class="c1"># NOTES:</span>
<span class="c1">#</span>
<span class="c1"># LICENSE:</span>
<span class="c1">#   &lt;your name&gt;  &lt;your email&gt;</span>
<span class="c1">#   Released under the same terms as Sensu (the MIT license); see LICENSE</span>
<span class="c1">#   for details.</span>
<span class="c1">#</span>
</pre></div>
</td></tr></table>

<h2>Documentation</h2>
<p>All documentation will be handled by <a href="https://github.com/rdoc/rdoc">RDoc</a> and we are using the default rdoc markup at this time. A brief introduction RDoc markup can be found <a href="http://docs.seattlerb.org/rdoc/RDoc/Markup.html">here</a>. All scripts should have as much documentation coverage as possible, ideally 100%.  You can test your coverage by installing RDoc locally and running</p>
<div class="highlight"><pre>rdoc -C &lt;filename&gt;
</pre></div>


<p>The output will tell you how much coverage you have without spending the time building the docs.  </p>
<p>Documentation can always be made better, if you would like to contribute to it, have at it and submit a PR.</p>
<h2>Dependency Managment</h2>
<p>Dependencies (ruby gems, packages, etc) and other requirements should
be declared in the header of the plugin/handler file.  Try to use the standard library or the same dependencies as other plugins to keep the stack as small as possible.  If you have questions about using a specific gem feel free to ask.</p>
<p>All scripts should contain the following dependency to ensure full compatibility.</p>
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">&#39;rubygems&#39;</span> <span class="k">if</span> <span class="no">RUBY_VERSION</span> <span class="o">&lt;</span> <span class="s1">&#39;1.9.0&#39;</span>
</pre></div>


<h2>Vagrant Box</h2>
<p>There is a Vagrantfile with shell provisioning that will setup the major versions of Ruby and a sensu gemset for each if you wish to use it.  To get started install <a href="https://www.vagrantup.com/">Vagrant</a> then type <em>vagrant up</em> in the root directory of the repo.  Once it is up type <em>vagrant ssh</em> to remote into the box and then <em>cd /vagrant &amp;&amp; bundle install</em> to set all necessary dependencies.</p>
<p>The box currently defaults to Ruby 2.1.4 but has 1.9.2, 1.9.3 and 2.0.0 installed as well.  See the file comments for further details.</p>
<h2>Testing</h2>
<h3>Linting</h3>
<p>Only pull requests passing lint/tests will be merged.</p>
<p>Rubocop is used to lint the style of the ruby plugins. This is done
to standardize the style used within these plugins, and ensure high
quality code.  Most current rules are currently in effect.  No linting is done on Ruby code prior to version 1.9.3 as Rubocop requires 1.9.2 and linting for it is identical to 1.9.3.  See the <a href=".travis.yml">travis.yml</a> and <a href="Rakefile">Rakefile</a> for details on what tests and versions are currently supported.  There are currently no plans to support Ruby 1.8.x</p>
<p>You can test rubocop compliance for yourself by installing the gem and running <i>rubocop</i> from the command line.
Running <i>rubocop -a</i> will attempt to autocorrect any issues, saving yourself considerable time in large files.</p>
<p>If it truely makes sense for your code to violate a rule you can disable that rule with your code by either using</p>
<div class="highlight"><pre># rubocop:disable &lt;rule&gt;, &lt;rule&gt;
</pre></div>


<p>at the end of the line in violation or</p>
<div class="highlight"><pre><span class="n">rubocop</span><span class="o">:</span><span class="n">disable</span> <span class="o">&lt;</span><span class="n">rule</span><span class="o">&gt;,</span> <span class="o">&lt;</span><span class="n">rule</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">code</span> <span class="n">block</span><span class="o">&gt;</span>
<span class="n">rubocop</span><span class="o">:</span><span class="n">enable</span> <span class="o">&lt;</span><span class="n">rule</span><span class="o">&gt;,</span> <span class="o">&lt;</span><span class="n">rule</span><span class="o">&gt;</span>
</pre></div>


<p>If you use either of these methods please mention in the PR as this should be kept to an absolute minimum at times, especially concerning method length and complexity, it makes sense to use on of the above methods.</p>
<h3>Rspec</h3>
<p>Currently we have RSpec3 as a <a href="https://github.com/sensu/sensu-plugin-spec">test framework</a>. Please add coverage for your check.  Checks will not be considered production grade and stable until they have complete coverage.</p>
<p>You can use the included Vagrantfile for easy testing.  All necessary versions of Ruby can be installed with their own dedicated gem sets using RVM.  Just boot up the machine and drop into /vagrant and execute</p>
<p>rake default</p>
<p>to run all specs and rubocop tests.  RSpec tests are currently run against 1.9.2, 1.9.3, 2.0, and 2.1.  There are currently no plans to support 1.8.x.</p>
<p>This is ~~little bit hard~~ almost impossible for non-ruby checks. Let someone from <a href="https://github.com/sensu?tab=members">team</a> know and maybe can can help.</p>
<h2>Issue and Pull Request Submissions</h2>
<p>If you see something wrong or come across a bug please open up an issue.  Try to include as much data in the issue as possible.  If you feel the issue is critical than tag a core  member and we will respond as soon as is feasible.</p>
<p>When submitting a pull request please follow the guidelines below for the quickest possible merge.  These not only make our lives eaiser, but also keep the repo and commit history as clean as possible.</p>
<ul>
<li>When at all possible do a  <code>git pull --rebase</code> both before you start working on the repo and then before you commit.  This will help ensure you have the most up to date codebase, Rubocop rules, and documentation.  It will also go along way towards cutting down or eliminating(hopefully) annoying merge commits.
*</li>
</ul>
<p>If you wish to track the status of your PR or issue, check out our <a href="https://waffle.io/sensu/sensu-community-plugins">waffle.io</a>.  This single location will allow contributers to stay on top of interwinding issues more effectively.</p>
<p>Please do not not abandon your pull request, only you can help us merge it. We will wait for feedback from you on your pull request for up to one month. A lack of feedback in one month may require you to re-open your pull request.  </p>
<h2>Technical Debt</h2>
<p>For those who don't deal with or understand technical debt, it is debt incurred when designing or developing software.  All the #FIXME, #HACK, etc littered through a script add up over time, this is your technical debt.</p>
<h3>Technical Debt Levels</h3>
<p><strong>YELLOW</strong></p>
<ul>
<li>simple issues that require basic Ruby and no more than 4 hours to fix</li>
</ul>
<p><strong>ORANGE</strong></p>
<ul>
<li>these may require 4 - 8 hours but still only a basic or intermediate Ruby skillset</li>
</ul>
<p><strong>RED</strong></p>
<ul>
<li>may require 8+ hours or some domain specific Ruby skills such as Amazon, or Elastic Search</li>
</ul>
<p>In order to quantify it and see what we actually have there is a rake task <em>calculate_debt</em>.  In order to run it you will need an auth token and write access to the repo.</p>
<p>There are three locked issues on Github corresponding the to level of debt, if you want to help out just grab a file and tag it for fixing by either the original maintainer or another community member or fix it yourself if you can and submit a PR.</p>
        </div>
    </section>
        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">



    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container-fluid">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy;  varied
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="/theme/js/respond.min.js"></script>


</body>
</html>